# Deep representation clustering-based fault diagnosis method with unsupervised data applied to rotating machinery
## Abstract
최근 지능형 데이터 기반 기계 고장 진단의 발전에도 불구하고, 모델 교육에는 대부분의 고품질 감독 데이터가 필요합니다. 그러나 실제 산업에서 충분한 레이블 데이터를 수집하는 것은 일반적으로 어렵고 비용이 많이 들고 데이터 준비의 어려움은 지능형 진단 방법의 적용을 크게 방해합니다. 불충분 한 레이블 데이터로 인한 데이터 희소성 문제를 해결하기 위해 본 연구에서는 일반적으로 수집하기 쉬운 추가 비지도 데이터를 탐색하는 딥 러닝 기반 결함 진단 방법을 제안합니다. 3 단계 훈련 계획, 즉 사전 훈련, 표현 클러스터링 및 강화 된 감독 학습이 채택됩니다. 자동 인코더 구조는 특징 추출에 사용되며, 비지도 학습을 위해 거리 측정 학습 및 k- 평균 클러스터링 방법이 신경망 아키텍처에 통합됩니다. 두 개의 회전 기계 데이터 세트가 유효성 검사에 사용됩니다. 제안 된 방법은 레이블이 지정된 데이터가 거의없는 준지도 학습 과제에 대한 유망한 진단 성능을 달성 할뿐만 아니라 순수한 비지도 학습 문제에도 적합합니다. 실험 결과는 제안 된 방법이 결함 진단을 위해 감독되지 않은 데이터를 활용하는 유망한 접근 방식을 제공함을 시사합니다.  
  
## 1. Introduction
현대 산업에서는 회전 기계의 상태 모니터링 및 상태 관리가 매우 중요합니다. 시기 적절하고 정확한 기계 결함 진단은 항상 유지 보수 비용을 줄이고 작동 안전성을 높이며 기계 신뢰성을 향상시킬 수있는 매우 요구되어 왔습니다 [1,2]. 문헌에서 물리적 모델과 신호 처리 기술에 기반한 기존의 오류 진단 방법은 잘 확립되어 있습니다 [3-6]. 그러나 특히 지능형 제조, 항공 우주 산업 등과 같은 고급 산업에서 회전 기계의 급속한 발전으로 인해 기존의 접근 방식은 복잡한 기계 시스템의 기계 결함을 정밀하게 진단 할 수있는 능력이 떨어지고 있습니다. 최근 몇 년 동안 감지 기술과 컴퓨팅 알고리즘의 발전에 힘 입어 지능형 데이터 기반 오류 진단 방법은 높은 정확도, 빠른 응답 및 특별한 전문 지식에 대한 낮은 요구 사항으로 인해 점점 더 많은 관심을 받고 있습니다. 수집 된 원시 데이터와 기계 상태 사이의 직관적 인 관계를 구축 할 수있어 실제 산업에서 데이터 기반 오류 진단 방법의 실제 적용을 크게 촉진 할 수 있습니다 [7,8].  
  
최근에는 신경망 기반 접근 방식이 성공적이고 널리 개발되었으며 유망한 진단 결과를 얻었습니다. 기본적인 다층 퍼셉트론 (MLP) 아키텍처 외에도 컨볼 루션 신경망 (CNN) [9-12] 및 반복 신경망 (RNN) [13]과 같은 변형도 기계 결함 진단에 널리 사용되었습니다. 지능형 결함 진단을위한 2 단계 학습 접근 방식은 Lei et al. [14], 특징 추출을 위해 희소 필터링과 2 계층 신경망을 채택하고 기계 상태 상태 분류를 위해 소프트 맥스 회귀를 사용합니다. 스파 스 자동 인코더 아키텍처는 Sun 등이 제안했습니다. 유도 모터 고장 진단을위한 감독되지 않은 심층 신경망에서 [15]. 학습 된 특징 표현의 견고성을 향상시키기 위해 입력 데이터의 부분 손상이 추가되었습니다. Lu et al. [16]은 환경 소음 및 작업 조건 변동을 포함하는 신호로 기계 오류 식별을 위해 스택 형 노이즈 제거 자동 인코더를 사용했습니다. 최근 심층 학습 기반 오류 진단의 발전은 고차원 기계 신호 처리에 대한 새로운 데이터 기반 알고리즘의 효과를 입증했으며, 충분한 감독 교육 데이터가있는 기존 진단 작업이 잘 해결되었습니다 [17,18].  
  
문헌에보고 된 지능형 방법의 유망한 진단 성능에도 불구하고 현재 연구의 주요 한계 중 하나는 교육을위한 충분한 감독 데이터의 가용성에 있습니다. 실제 산업 시나리오에서는 시스템 불확실성과 인건비를 고려할 때 특정 기계 상태 조건, 특히 심각한 결함 상태에서 데이터를 정확하게 수집하는 것이 일반적으로 어렵고 비용이 많이 듭니다. 따라서 레이블이 지정된 고품질 기계 데이터는 대부분의 경우 부족합니다. 결과적으로 제한된 감독 데이터를 탐색함으로써 강력한 모델 기능을 갖춘 최신 데이터 기반 결함 진단 방법을 사용하여 과적 합 현상이 쉽게 발생할 수 있으며 테스트 데이터에 대한 모델 성능이 크게 저하됩니다. 그림 1에서 볼 수 있듯이 데이터 희소성 문제는 지능형 진단 모델의 일반화 성능에 현저한 영향을 미치므로 실제 산업에서의 적용을 방해합니다.  
  
![figure 1](./img/fig1.PNG)  
  
데이터 희소성 문제를 해결하기 위해 실제 데이터를 기반으로 추가 샘플을 생성하여 제한된 감독 데이터 세트를 확장하는 것을 목표로 다양한 데이터 증대 방법이 제안되었습니다. 예를 들어, 합성 오버 샘플링 접근법은 실제 샘플의 보간을 통해 새로운 샘플을 생성 할 수있는 데이터 증대에서 널리 사용되었습니다 [19,20]. 사용 가능한 데이터의 변환은 데이터 증가에도 사용되어 모델 학습을 지원하는 추가 데이터 변형이 발생합니다. Li et al. [21]은 추가 노이즈, 시간 확장 등과 같은 다양한 신호 처리 기법을 사용하는 데이터 증가 방법을 제안했습니다. 결과는 딥 러닝 기반의 오류 진단 방법이 더 많은 레이블이 지정된 인스턴스가 생성 된 확장 된 데이터 세트의 이점을 크게 누릴 수 있음을 보여줍니다. 데이터 희소성과 유사한 데이터 불균형 문제와 관련하여 Zhang et al. [22]는 소수 클래스의 데이터 증가를 위해 가중 소수 오버 샘플링이라고하는 향상된 합성 오버 샘플링 접근 방식을 제안했습니다. 나중에 오류 진단을 위해 깊은 자동 인코더와 의사 결정 트리가 사용되었습니다. Bunkhumpornpat et al. 각 소수 클래스 인스턴스에 안전 수준을 할당하고 그에 따라 새로운 데이터를 생성하기 위해 인기있는 합성 소수 오버 샘플링 기법 (SMOTE)을 구현하는 Safe-Level-SMOTE 방법 [23]을 제안했습니다. 훈련 데이터 세트는 데이터 증가를 사용하여 명시 적으로 확대 할 수 있지만 새 샘플은 일반적으로 실제 샘플과 유사하고 데이터의 다양성이 충분하지 않으며 모델 일반화의 제한된 개선은 일반적으로 달성 될 수 있습니다 [21,24–26].  
  
결함 진단 작업에서 레이블이 지정된 데이터를 수집하는 데 어려움이 있음에도 불구하고 정밀한 기계 상태 정보가없는 감독되지 않은 데이터는 일반적으로 쉽게 측정 할 수 있습니다 [27,28]. 데이터 증가를 통해 인위적으로 생성 된 샘플 대신, 감독되지 않은 데이터가 실제 운영 조건에서 수집되어 더 강력한 유효성과 다양성을 유지합니다. 데이터 중심의 오류 진단 방법은 감독되지 않은 데이터의 활용으로 이익을 얻을 것으로 예상되며 더 강력한 모델 일반화 능력을 얻을 수 있습니다. 지도 및 비지도 데이터를 모두 탐색하는 데이터 기반 작업은 반지도 학습 문제로도 알려져 있습니다 [29-31].  
  
결함 진단의 준지도 학습 과제는 지난 몇 년 동안 증가하는 연구 관심을 받고 있습니다 [32]. Razavi-Far et al. [33]은 정보 융합 및 의사 결정의 두 가지 모듈을 포함하는 여러 결함을 진단하기위한 반 감독 심층 학습 체계를 개발했습니다. 학습 프레임 워크에서 훈련 중 인간 상호 작용을 최소화하고 진단 효율성을 향상시킬 수 있습니다. 장애를 진단하기위한 하이브리드 데이터 기반 방식이 [34]에서 제안되었는데, 훈련 데이터는 대부분 감독되지 않고 원시 진동 신호는 의사 결정을위한 효율적인 기능으로 점진적으로 변환됩니다. 일반 정규화 된 희소 필터링이라는 비지도 학습 방법은 Zhang et al. [35], 특징 추출 및 결함 진단을 위해 소량의 학습 샘플이 사용됩니다. 그 효과는 구름 베어링과 유성 기어에 대한 실험을 통해 검증되었습니다. Liu et al. [27]은 구름 베어링의 감독되지 않은 결함 진단을위한 범주 형 적대적 자동 인코더를 제안했습니다. 자동 인코더는 적대적 훈련 체계를 사용하여 최적화되며, 더 나은 샘플 클러스터링을 위해 잠재 공간에 대한 사전 분포가 부과됩니다.  
  
본 논문에서는 감독 데이터가 적고 감독되지 않은 데이터가 충분한 회전 기계에 대한 딥 러닝 기반 고장 진단 방법을 제안한다. 자동 인코더 아키텍처는 먼저 높은 수준의 기능을 학습하는 데 사용되며 비지도 학습에는 딥 표현 클러스터링 방법이 채택됩니다. 거리 측정 학습 및 k- 평균 클러스터링 접근법은 제안 된 프레임 워크에 통합됩니다. 의사 레이블은 감독되지 않은 데이터에 부착되어 향상된 오류 진단 모델을 교육하는 데 더 많이 사용됩니다. 제안 된 방법을 검증하기 위해 두 개의 회전 기계 데이터 세트에 대한 실험이 구현되고, 서로 다른 반 감독 및 비지도 학습 작업에서 유망한 결과를 얻습니다.  
  
제안 된 방법은 기계 작동 조건의 변화에 ​​대한 강력한 일반화 능력을 달성 할 수 있으며 그 결과는 기존 관련 연구와 경쟁이 치열합니다. 훈련 및 테스트 데이터가 다른 분포를 따르는 경우 (예 : 데이터는 서로 다른 회전 속도에서 수집되며, 전이 학습 기술이 널리 사용되었습니다 [36-39]. 특히, 도메인 적응 방법은 도메인 이동 현상이있을 때 도메인 불변 특징을 추출하는 것을 목표로하는 교차 도메인 결함 진단 연구 [40,41]에서 훨씬 선호되었습니다 [38,42–44]. Lu et al. 도메인 간 최대 평균 불일치 (MMD)를 최소화하고 도메인 간 장애 진단 문제에서 네트워크 최적화 목표에 가중치 용어를 채택했습니다.  
  
이 논문은 준지도 학습 문제에 대한 회전 기계 결함 진단을위한 딥 러닝 기반 방법을 제안하며, 이는 비지도 학습 작업으로 확장 될 수도 있습니다 [46]. 대부분의 기존 연구와 달리 원시 주파수 영역 정보는 수작업으로 만들어진 기능이 아닌 모델 입력으로 사용되어 잠재적 인 응용 프로그램을 크게 촉진합니다. 제안 된 방법은 약하게 감독 된 데이터로 유망한 진단 성능을 달성 할 수 있으며 대부분의 데이터 기반 접근 방식으로 대량의 고품질 라벨링 된 샘플에 대한 요구 사항을 완화 할 수 있습니다. 비지도 학습을 통해 다양한 작동 조건에 대한 강력한 견고성을 얻을 수도 있으며 실제 산업 시나리오에서 레이블이없는 데이터를 더 잘 활용할 수 있습니다.  
  
이 논문의 나머지 부분은 2 장에서 제안 된 고장 진단 방법으로 시작한다. 3 장에서 검증과 조사를위한 실험이 수행된다. 4 장에서 결론을 내리고 논문을 마무리한다.  
  
## 2. Proposed method
### 2.1. Problem formulation
이 논문은 테스트 데이터 셋 D<sub>test</sbu> = {(x<sub>i</sub><sup>test</sup>, y<sub>i</sub><sup>test</sup>)}<sub>i=1</sub><sup>n<sub>test</sub></sup> x<sub>i</sub><sup>test</sup>에 대한 강력한 일반화 능력을 보유한 D<sub>sp</sub> 및 D<sub>un</sub>을 기반으로 결함 진단 분류기 f를 구축하는 것을 목표로합니다.여기서 x<sub>test</sub><sup>i</sup>는 샘플 데이터를 나타내고, y<sup>test</sup><sub>i</sub>는 해당 레이블이며 n<sub>test</sub>는 테스트 샘플의 수입니다. 작동 조건의 변화에 대해 제안 된 방법의 견고성을 평가하기 위해 D<sub>sp</sub>; D<sub>un</sub> 및 D<sub>test</sub>의 데이터 공간은 서로 다를 수 있지만 라벨 공간은 일반적으로 오류 진단 문제 (예 : 기계 상태)에서 동일합니다. 조건은 다른 데이터 세트에서 동일합니다.  

### 2.2. Overview
그림 2는 제안 된 방법의 개요를 보여준다. 첫째, 원시 기계 진동 가속 데이터는 센서에 의해 수집됩니다. 고속 푸리에 변환 (FFT)을 사용하면 주파수 영역 정보가 샘플 데이터로 사용됩니다. 일반적으로 제안 된 결함 진단 체계에는 사전 훈련, 표현 클러스터링 및 강화 된지도 학습의 세 단계가 사용됩니다. 첫 번째 사전 훈련 단계에서는 감독되지 않은 데이터와 감독되지 않은 데이터의 높은 수준의 표현이 감독되지 않은 접근 방식으로 학습되고 자동 인코더 신경망이 사용됩니다. 다음으로 k- 평균 클러스터링 방법이 프레임 워크에 통합되어 상위 수준 데이터 표현을 입력으로 사용합니다. 거리 측정법 학습을 사용하여 특성을 최적화하면 좋은 클러스터링 효과를 얻을 수 있으며 클러스터링 된 레이블이없는 샘플에 의사 레이블을 할당 할 수 있습니다. 이러한 방식으로 레이블이 지정된 데이터 세트를 크게 확대하여 나중에 차별 모델을 훈련하는 데 사용할 수 있습니다.  
  
![fig 2](./img/fig2.PNG)  
  
### 3.4. Stage 1: Pre-training
첫째, 제안 된 신경망 모델은 오토 인코더 구조를 사용하여 높은 수준의 데이터 표현을 얻기 위해 사전 훈련됩니다. 일반적으로 자동 인코더에는 인코더와 디코더의 두 가지 모듈이 사용됩니다. 입력 샘플 데이터 x의 경우, 매개 변수 θ<sub>en</sub>이있는 인코딩 함수 f<sub>en</sub>이 특성 x<sub>f</sub> = f<sub>en</sub>(x)의 추출에 사용됩니다. 디코딩 기능 f<sub>de</sub>가있는 디코더 모듈은 추출 된 특징 x<sub>f</sub>를 기반으로 원래 데이터 x를 재구성하는 것을 목표로하며 f<sub>de</sub>의 매개 변수는 θ<sub>de</sub>로 표시됩니다. 요약하면 자동 인코더 모델 f<sub>ae</sub>는 다음과 같이 공식화 될 수 있습니다.  

![equation 1](./img/equation1.PNG)  
  
여기서 x는 자동 인코더의 출력을 나타냅니다.  
  
자동 인코더의 신경망 아키텍처는 그림 3에 나와 있습니다.이 연구에서는 컨볼 루션 신경망 (CNN) [18,47]이 대부분 데이터 처리에 채택되었습니다.  
  
![fig 3](./img/fig3.PNG)  
  
특히, 인코더 모듈에는 필터 번호가 각각 32, 16 및 8 인 3 개의 컨벌루션 레이어가 사용됩니다. 드롭 아웃 기술은 정규화를 위해 각 레이어 다음에 사용됩니다. 평탄화 층 이후에는 N<sub>rep</sub> 뉴런이있는 완전히 연결된 층이 채택됩니다. 디코더의 구조는 인코더의 구조와 유사하며 32, 16 및 8 개의 필터가있는 3 개의 컨볼 루션 레이어가 사용됩니다. N<sub>input</sub> 뉴런이있는 완전히 연결된 레이어는 재구성 된 데이터 샘플을 나타내는 평면화 후에 채택됩니다. 재구성 오류 L<sub>ae</sub>를 최소화하여 모델 매개 변수 θ<sub>en</sub> 및 θ<sub>de</sub>를 최적화 할 수 있습니다.  
  
![equation 2](./img/equation2.PNG)  
  
여기서 n<sub>pre</sub>는 일반적으로 감독 및 비지도 훈련 데이터를 모두 포함하는 사전 훈련 단계의 샘플 수를 나타냅니다. ^θ<sub>en</sub> 및 ^ θ<sub>de</sub>는 각각 θ<sub>en</sub> 및 θ<sub>de</sub>의 최적 값을 나타냅니다. 재구성의 L1 거리 오차는 노이즈에 대한 모델 견고성을 향상시키기 위해 고려됩니다. 최적화 문제는 확률 적 경사 하강 법 (SGD) 알고리즘을 사용하여 쉽게 해결할 수 있으며 매개 변수는 다음과 같이 최적화 할 수 있습니다.  
  
![equation 3](./img/equation3.PNG)  
  
여기서 δ는 학습률을 나타냅니다. 이런 식으로 학습 된 기능 x는 x의 고수준 표현입니다.
  
### 2.4. Stage 2: Representation clustering
여기서 d는 학습률을 나타냅니다. 이러한 방식으로 학습 된 특징 x<sub>f</sub>는 x의 고수준 표현이되며, 네트워크 사전 훈련 후 준지도 및 비지도 학습을위한 심층 표현 클러스터링 방법이 제안됩니다. k- 평균 클러스터링 접근 방식은 딥 러닝 프레임 워크에 통합되고 거리 측정법 학습은 기능 최적화에 사용됩니다. k- 평균 접근법은 일련의 샘플을 입력으로 취하고 기하학적 기준에 따라 여러 그룹으로 클러스터링합니다 [48]. 본 연구에서는 인코더에 의해 추출 된 특징을 k- 평균 방법에 입력하고, 각 그룹은 중심 {μ<sub>k</sub>}<sup>N<sub>cluster</sub></sup><sub>k=1</sub>로 표시됩니다. 여기서 N<sub>cluster</sub>는 그룹 수를 나타냅니다. 감독 된 데이터 D<sub>sp</sub> = {(x<sup>sp</sup><sub>i</sub>, y<sup>sp</sup><sub>i</sub>)}<sup>n<sub>sp</sub></sup><sub>i=1</sub> 및 감독되지 않은 데이터 D<sub>un</sub> = {x<sup>un</sup><sub>i</sub>}n<sup>un</sup><sub>i=1</sub>을 교육에 사용할 수 있습니다. 사전 훈련 된 인코더를 기반으로 x<sup>sp</sup><sub>i=1</sub>의 고수준 표현은 k- 평균 클러스터링에서 중심의 초기 위치를 결정하는 데 사용되는 f<sub>en</sub>(x<sup>sp</sup><sub>i</sub>)로 얻을 수 있습니다.  
  
N<sub>class</sub>가 기계 상태 상태의 수를 나타냅니다. 반지도 학습에서 N<sub>class</sub>는 사용자에게 알려져 있으며 N<sub>cluster</sub>는 해당 클러스터링에 대해 N<sub>class</sub>와 동일하게 설정 될 수 있습니다. 또한 제안 된 방법은 기계 상태 정보를 사용할 수없는 비지도 학습에도 적합하므로 N<sub>class</sub>가 사용자에게 알려지지 않은 것으로 간주됩니다. 비지도 학습에서 N<sub>cluster</sub>와 N<sub>class</sub>는 서로 다를 수 있습니다. 다음에서는 단순성을 위해 N<sub>cluster</sub> =  N<sub>class</sub>로 가정합니다.  
  
이 단계에서는 감독되지 않은 데이터의 의사 레이블을 얻기 위해 최적화의 반복 방식이 제안됩니다. 이 연구에서 에피소드로 표시되는 각 반복에서 (1) 중심이 먼저 초기화되고 (2) k- 평균 클러스터링 접근 방식이 구현되고 (3) 거리 메트릭 학습 방법이 이후에 채택되어 특징 추출기의 매개 변수, 즉 인코더.  
  
#### (1) Initialization
중심의 위치를 초기화하려면  
  
![equation 4](./img/equation4.PNG)  
  
여기서 x<sup>sp,k</sup><sub>f</sub>는 k 번째 클래스에 속하는 레이블이 지정된 샘플의 고수준 표현 집합을 나타내고 x<sup>sp,k</sup><sub>f</sub>는 x<sup>sp,k</sup><sub>f</sub>에있는 벡터의 평균입니다. 식. (4)는 중심이 각 클래스에서 감독되는 데이터의 수단으로 초기화되었음을 제안합니다. 비지도 학습 작업에서 중심은 대신 무작위로 초기화 될 수 있습니다.
